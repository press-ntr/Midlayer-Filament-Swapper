# Mid-Layer Filament Swapper

## Overview

This project provides a simple, browser-based tool to modify G-code files generated by Bambu Studio to enable **mid-layer filament changes** on Bambu Lab printers *without* needing an Automatic Material System (AMS).

Bambu Studio typically only allows filament changes at the *start* of a new layer when preparing multi-color or multi-material prints. This tool injects a special pause command (`M400 U1`) into your G-code at specific points, allowing your printer to pause gracefully and wait for you to manually swap filaments. This is perfect for creating multi-color prints with intricate details or for embedding objects mid-print, even if you don't have an AMS unit.

Since this method requires manual intervention every time that a filament swap is requested, it is recommended that filament swaps be kept to just a few layers. This method works best for embedding text/designs into the bottom or top layer of a print and is NOT meant to replace the AMS for fully multi-colored prints.

## How to Use

### 1. Prepare Your G-code for Multi-Filament Prints

If you're looking to print with multiple colors or materials on a single-extruder printer (without an AMS), you'll need to prepare your G-code correctly in your slicer. Here's a general guide, focusing on Bambu Studio:

* **Step 1: Open Your Model & Add Filaments**
    1.  Start by opening your 3D model (e.g., an STL or 3MF file) in Bambu Studio.
    2.  Add at least one additional filament to your project. This will typically give you two or more filament slots to work with. For example, if you're printing in two colors, you'll need two distinct filament profiles.
* **Step 2: Assign Colors to Objects/Parts**
    1.  If your model consists of multiple separate objects, select each object and assign it a different color (filament) from the available slots.
    2.  If your model is a single object with different parts you want to color, use the "Paint" tool or "Split to Parts" function in Bambu Studio to separate the sections and assign colors accordingly.
* **Step 3: Configure Print Settings**
    1.  Select your desired print settings (layer height, infill, supports, etc.) as you normally would for your printer and chosen filaments.
    2.  **Disable "Prime Tower".** This setting is typically found under the "Others" tab in your print settings. A prime tower purges filament to a separate structure, which isn't necessary and can cause issues with manual pauses.
* **Step 4: Slice and Export G-code**
    1.  Once all settings are configured and colors are assigned, proceed to "Slice Plate". This will generate the G-code for your print.
    2.  After slicing, export the G-code file. In Bambu Studio, this is usually done via `File -> Export -> Export G-Code...`. Save the file to your computer.
    3.  This exported G-code file is what you will upload to the tool for patching. The tool will automatically insert pauses before each filament change.

### 2. Patch Your G-code with the Tool

1.  **Upload File**: Go to the tool's webpage and upload your `.gcode` file by dragging and dropping it into the designated area or clicking to browse.
2.  **Patch G-code**: Click the "Patch G-code" button.
3.  **Download**: Once processed, a "Download Patched G-code" link will appear. Click this to save your modified file.

### 3. Printing

Once you've patched your G-code, you're ready to get it to your printer and handle the manual filament changes.

Choose **ONE** of the following methods to transfer your patched G-code file to your printer:

* **Option 1: SD Card**
    1.  Insert your SD card into your computer.
    2.  Navigate to the `models` folder.
    3.  Copy the `-patched.gcode` file into that folder.
    4.  Safely eject the SD card and insert it into your printer.
    5.  Select the file on the printer and start printing.

* **Option 2: Bambu Studio v1**
    1.  Open [Bambu Studio v1](https://github.com/bambulab/BambuStudio/releases/tag/v01.10.02.76) (note: v2 cloud upload currently doesn't support the patch).
    2.  Drag your `-patched.gcode` into the prepare window.
    3.  Review the preview to confirm it looks correct.
    4.  Click **Send to Printer** to begin the print.

Once your print starts, the printer will pause at specific points for you to swap filaments. Hereâ€™s how to handle it:

1.  The printer will **pause automatically** at the designated layer and display a message, likely stating "Filament Change Required" or similar. **DO NOT press 'Resume' on this screen!**
2.  Instead of resuming, locate and press the **'X' button** (or 'Cancel' / 'Back' depending on your printer's UI) to exit this prompt.
3.  Navigate to the **'Filament' or 'Change Filament' section** on your printer's screen.
4.  Perform the **manual filament change** following your printer's usual procedure. This typically involves unloading the old filament, loading the new filament, and purging any old material until the new color is clean.
5.  Once the filament change is complete, return to the **main print screen** on your printer.
6.  Finally, press **'Resume'** to continue your print. The printer will seamlessly pick up where it left off with the new filament!

## Contributing

Feel free to open issues or submit pull requests if you have suggestions for improvements, bug fixes, or new features.